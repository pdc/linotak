var app=function(){"use strict";function t(){}function e(t){return t()}function n(){return Object.create(null)}function o(t){t.forEach(e)}function i(t){return"function"==typeof t}function r(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}function u(t,e){t.appendChild(e)}function c(t,e,n){t.insertBefore(e,n||null)}function s(t){t.parentNode.removeChild(t)}function l(t){return document.createElement(t)}function f(t){return document.createElementNS("http://www.w3.org/2000/svg",t)}function a(t){return document.createTextNode(t)}function d(){return a(" ")}function h(t,e,n,o){return t.addEventListener(e,n,o),()=>t.removeEventListener(e,n,o)}function m(t,e,n){null==n?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function p(t,e,n){t.setAttributeNS("http://www.w3.org/1999/xlink",e,n)}function g(t){return""===t?null:+t}function $(t,e){t.value=null==e?"":e}let y;function w(t){y=t}function v(t){(function(){if(!y)throw new Error("Function called outside component initialization");return y})().$$.on_mount.push(t)}const x=[],_=[],b=[],k=[],E=Promise.resolve();let B=!1;function M(t){b.push(t)}let A=!1;const X=new Set;function Y(){if(!A){A=!0;do{for(let t=0;t<x.length;t+=1){const e=x[t];w(e),L(e.$$)}for(w(null),x.length=0;_.length;)_.pop()();for(let t=0;t<b.length;t+=1){const e=b[t];X.has(e)||(X.add(e),e())}b.length=0}while(x.length);for(;k.length;)k.pop()();B=!1,A=!1,X.clear()}}function L(t){if(null!==t.fragment){t.update(),o(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(M)}}const S=new Set;function q(t,e){-1===t.$$.dirty[0]&&(x.push(t),B||(B=!0,E.then(Y)),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function N(r,u,c,l,f,a,d=[-1]){const h=y;w(r);const m=u.props||{},p=r.$$={fragment:null,ctx:null,props:a,update:t,not_equal:f,bound:n(),on_mount:[],on_destroy:[],before_update:[],after_update:[],context:new Map(h?h.$$.context:[]),callbacks:n(),dirty:d,skip_bound:!1};let g=!1;if(p.ctx=c?c(r,m,(t,e,...n)=>{const o=n.length?n[0]:e;return p.ctx&&f(p.ctx[t],p.ctx[t]=o)&&(!p.skip_bound&&p.bound[t]&&p.bound[t](o),g&&q(r,t)),e}):[],p.update(),g=!0,o(p.before_update),p.fragment=!!l&&l(p.ctx),u.target){if(u.hydrate){const t=function(t){return Array.from(t.childNodes)}(u.target);p.fragment&&p.fragment.l(t),t.forEach(s)}else p.fragment&&p.fragment.c();u.intro&&(($=r.$$.fragment)&&$.i&&(S.delete($),$.i(v))),function(t,n,r){const{fragment:u,on_mount:c,on_destroy:s,after_update:l}=t.$$;u&&u.m(n,r),M(()=>{const n=c.map(e).filter(i);s?s.push(...n):o(n),t.$$.on_mount=[]}),l.forEach(M)}(r,u.target,u.anchor),Y()}var $,v;w(h)}function C(t){let e,n;return{c(){e=l("label"),n=a(t[5]),m(e,"for","id_focus_x")},m(t,o){c(t,e,o),u(e,n)},p(t,e){32&e&&function(t,e){e=""+e,t.wholeText!==e&&(t.data=e)}(n,t[5])},d(t){t&&s(e)}}}function j(e){let n,i,r,a,y,w,v,x,_,b,k,E,B,M,A,X,Y,L,S,q,N,j,O,T,F,H,I=e[5]&&C(e);return{c(){n=l("div"),i=f("svg"),r=f("image"),a=f("circle"),x=f("rect"),B=f("rect"),S=d(),q=l("div"),I&&I.c(),N=d(),j=l("input"),O=d(),T=l("input"),p(r,"xlink:href",e[4]),m(r,"width",e[0]),m(r,"height",e[1]),m(a,"cx",y=e[2]*e[0]),m(a,"cy",w=e[3]*e[1]),m(a,"r",v=32),m(a,"stroke-width","1"),m(a,"stroke","#B0A"),m(a,"fill","none"),m(x,"x",_=e[10]+.5),m(x,"y",b=e[11]+.5),m(x,"width",k=e[14]-1),m(x,"height",E=e[15]-1),m(x,"stroke-width","1"),m(x,"stroke","#F56"),m(x,"fill","none"),m(B,"x",M=e[8]+.5),m(B,"y",A=e[9]+.5),m(B,"width",X=e[12]-1),m(B,"height",Y=e[13]-1),m(B,"stroke-width","1"),m(B,"stroke","#0BA"),m(B,"fill","none"),m(i,"class","im"),m(i,"width",e[0]),m(i,"height",e[1]),m(i,"viewBox",L="0 0 "+e[0]+" "+e[1]),m(j,"name","focus_x"),m(j,"id","id_focus_x"),m(j,"type","number"),m(j,"step","any"),j.required=!0,m(T,"name","focus_y"),m(T,"id","id_focus_y"),m(T,"type","number"),m(T,"step","any"),T.required=!0,m(n,"class","focus-editor")},m(t,o){c(t,n,o),u(n,i),u(i,r),e[17](r),u(i,a),u(i,x),u(i,B),u(n,S),u(n,q),I&&I.m(q,null),u(q,N),u(q,j),$(j,e[2]),u(q,O),u(q,T),$(T,e[3]),e[20](q),F||(H=[h(i,"mousedown",e[16]),h(j,"input",e[18]),h(T,"input",e[19])],F=!0)},p(t,[e]){16&e&&p(r,"xlink:href",t[4]),1&e&&m(r,"width",t[0]),2&e&&m(r,"height",t[1]),5&e&&y!==(y=t[2]*t[0])&&m(a,"cx",y),10&e&&w!==(w=t[3]*t[1])&&m(a,"cy",w),1024&e&&_!==(_=t[10]+.5)&&m(x,"x",_),2048&e&&b!==(b=t[11]+.5)&&m(x,"y",b),16384&e&&k!==(k=t[14]-1)&&m(x,"width",k),32768&e&&E!==(E=t[15]-1)&&m(x,"height",E),256&e&&M!==(M=t[8]+.5)&&m(B,"x",M),512&e&&A!==(A=t[9]+.5)&&m(B,"y",A),4096&e&&X!==(X=t[12]-1)&&m(B,"width",X),8192&e&&Y!==(Y=t[13]-1)&&m(B,"height",Y),1&e&&m(i,"width",t[0]),2&e&&m(i,"height",t[1]),3&e&&L!==(L="0 0 "+t[0]+" "+t[1])&&m(i,"viewBox",L),t[5]?I?I.p(t,e):(I=C(t),I.c(),I.m(q,N)):I&&(I.d(1),I=null),4&e&&g(j.value)!==t[2]&&$(j,t[2]),8&e&&g(T.value)!==t[3]&&$(T,t[3])},i:t,o:t,d(t){t&&s(n),e[17](null),I&&I.d(),e[20](null),F=!1,o(H)}}}function O(t,e,n){return e>n*t?[n*t,n]:[e,e/t]}function T(t,e,n){let o,i,r,u,c,s,l,f,a,d,{src:h}=e,{width:m}=e,{height:p}=e,{label:$}=e,{focusX:y=.5}=e,{focusY:w=.5}=e;return v(()=>{const t=document.documentElement.clientWidth,e=document.documentElement.clientHeight-i.clientHeight;(m>t||p>e)&&(m/p<t/e?(n(0,m*=e/p),n(1,p=e)):(n(1,p*=t/m),n(0,m=t)))}),t.$$set=t=>{"src"in t&&n(4,h=t.src),"width"in t&&n(0,m=t.width),"height"in t&&n(1,p=t.height),"label"in t&&n(5,$=t.label),"focusX"in t&&n(2,y=t.focusX),"focusY"in t&&n(3,w=t.focusY)},t.$$.update=()=>{3&t.$$.dirty&&n(12,[l,f]=O(1,m,p),l,(n(13,f),n(0,m),n(1,p))),4101&t.$$.dirty&&n(8,r=y*(m-l)+.5),8202&t.$$.dirty&&n(9,u=w*(p-f)+.5),3&t.$$.dirty&&n(14,[a,d]=O(16/9,m,p),a,(n(15,d),n(0,m),n(1,p))),49167&t.$$.dirty&&(a===m?(n(10,c=0),n(11,s=Math.min(p-d,Math.max(0,w*p-.5*d)))):(n(10,c=Math.min(m-a,Math.max(0,y*m-.5*a))),n(11,s=0)))},[m,p,y,w,h,$,o,i,r,u,c,s,l,f,a,d,function(t){const{left:e,top:i}=o.getBoundingClientRect(),r=t.clientX-e-y*m,u=t.clientY-i-w*p;if(r*r+u*u<=1024){t.preventDefault();const e=t=>{const{left:e,top:i}=o.getBoundingClientRect();n(2,y=Math.max(Math.min(1,(t.clientX-e-r)/m),0)),n(3,w=Math.max(Math.min(1,(t.clientY-i-u)/p),0))},i=t=>{t.target.removeEventListener("mousemove",e),t.target.removeEventListener("mouseup",i)};t.target.addEventListener("mousemove",e),t.target.addEventListener("mouseup",i)}},function(t){_[t?"unshift":"push"](()=>{o=t,n(6,o)})},function(){y=g(this.value),n(2,y)},function(){w=g(this.value),n(3,w)},function(t){_[t?"unshift":"push"](()=>{i=t,n(7,i)})}]}const F=document.getElementById("focus-ui-form"),H=F.focus_x.value,I=F.focus_y.value,R=document.getElementById("focus-ui"),z=R.querySelector("label"),D=z.innerText,P=R.querySelector("img"),W=P.src,G=P.width,J=P.height;z.remove(),P.remove(),F.focus_x.remove(),F.focus_y.remove();return new class extends class{$destroy(){!function(t,e){const n=t.$$;null!==n.fragment&&(o(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}(this,1),this.$destroy=t}$on(t,e){const n=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return n.push(e),()=>{const t=n.indexOf(e);-1!==t&&n.splice(t,1)}}$set(t){var e;this.$$set&&(e=t,0!==Object.keys(e).length)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}{constructor(t){super(),N(this,t,T,j,r,{src:4,width:0,height:1,label:5,focusX:2,focusY:3})}}({target:R,props:{src:W,width:G,height:J,focusX:H,focusY:I,label:D}})}();
//# sourceMappingURL=bundle.js.map
